(function(a,b){a.smartfiltersTheme=function(d,c){var g=this;g.filters=d;g.o=a.extend({parentLabelSelector:"label",parentParamSelector:".filter-param,p"},c);g.$form=f();if(g.$form){setTimeout(function(){i();h()},1000)}else{a.smartfiltersTheme.log("$.smartfiltersTheme fail: form not found")}function f(){var j=false;a.each(g.filters,function(l,k){if(!j||!j.length){j=a('[name^="'+l+'"]').closest("form");return false}});return j&&j.length?j:false}function i(){var j,p,q,m,n,k,t,l,o,s,r;a.each(g.filters,function(w,u){j=g.$form.find('input[name="'+w+'[]"]');if(j.length){k=j.closest(g.o.parentParamSelector);if(u.disabled&&!a.isEmptyObject(u.disabled)){j.each(function(v,y){p=a(y);n=p.val();m=(u.disabled.hasOwnProperty(n)&&u.disabled[n])||!u.values.hasOwnProperty(n);p.prop("disabled",m).trigger("refresh");q=m?"add":"remove";p.closest(g.o.parentLabelSelector)[q+"Class"]("sf-label-disabled")});q=j.filter(":not(:disabled)").length?"remove":"add";k[q+"Class"]("sf-param-disabled")}else{j.prop("disabled",false).trigger("refresh");j.closest(g.o.parentLabelSelector).removeClass("sf-label-disabled");k.removeClass("sf-param-disabled")}}else{if(u.hasOwnProperty("nmin")||u.hasOwnProperty("nmax")){t=g.$form.find('input[name="'+w+(w!=="price"?"[min]":"_min")+'"]');l=g.$form.find('input[name="'+w+(w!=="price"?"[max]":"_max")+'"]');if(u.hasOwnProperty("nmin")&&u.hasOwnProperty("nmax")){u.nmin=Math.floor(u.nmin);u.nmax=Math.ceil(u.nmax);k=l.closest(g.o.parentParamSelector);o=k.find(".ui-slider");if(w==="price"){e(k);e("$slider.length "+o.length)}if(o.length){try{s=o.slider("option","values");t.prop("placeholder",u.nmin);l.prop("placeholder",u.nmax);r=parseFloat(t.val());if(r.toString()!=="NaN"){if(r>u.nmax){s[0]=u.nmax;t.val(s[0])}else{s[0]=r}}else{l.val("");s[0]=u.nmin}r=parseFloat(l.val());if(r.toString()!=="NaN"){if(r<u.nmin){s[1]=u.nmin;l.val(s[1])}else{s[1]=r}}else{l.val("");s[1]=u.nmax}o.slider("option","values",s)}catch(x){e(x)}}}}else{if((j=g.$form.find('select[name="'+w+'[]"]'))&&j.length){k=j.closest(g.o.parentParamSelector);j=j.find("option");if(u.disabled&&!a.isEmptyObject(u.disabled)){j.each(function(v,y){p=a(y);n=p.prop("value");console.log(n);m=(u.disabled.hasOwnProperty(n)&&u.disabled[n])||!u.values.hasOwnProperty(n);p.prop("disabled",m).trigger("refresh")});q=j.filter(":not(:disabled)").length?"remove":"add";k[q+"Class"]("sf-param-disabled")}else{j.prop("disabled",false).trigger("refresh");k.removeClass("sf-param-disabled")}j.closest("select").trigger("refresh")}}}})}function h(){if(!a(b).data("smartfilters-event")){a(b).data("smartfilters-event",function(n,l,k){if(!/data-smartfilters-data/.test(l.responseText)){return}var j=a("<div>").html(l.responseText),m=j.find("[data-smartfilters-data]:first");if(m.length){m=m.text();m=a.parseJSON(m);g.filters=m;a.smartfiltersTheme(m,g.o)}})}a(b).unbind("ajaxSuccess",a(b).data("smartfilters-event"));a(b).bind("ajaxSuccess",a(b).data("smartfilters-event"))}function e(j){window.console&&console.log("$.smartfiltersTheme:",j)}}})(jQuery,document);